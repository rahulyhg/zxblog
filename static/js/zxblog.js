// Generated by CoffeeScript 1.4.0
var page_generator, sys_cfg;

sys_cfg = {
  about_url: '/static/about.html',
  portfolio_url: '/static/portfolio.html',
  portfolio_data_url: '/wp_api/v1/posts?category_name=portfolio&per_page=15'
};

angular.module('zxblog', ['ngRoute', 'ngResource']).config(function($routeProvider) {
  return $routeProvider.when('/about', {
    controller: 'AboutCtrl',
    templateUrl: sys_cfg.about_url
  }).when('/portfolio/:page', {
    controller: 'PortfolioCtrl',
    templateUrl: sys_cfg.portfolio_url
  }).otherwise({
    redirectTo: '/about'
  });
}).controller('PortfolioCtrl', function($rootScope, $scope, $routeParams, portFactory) {
  var ports_info;
  $rootScope.$pg_type = 'portfolio';
  $rootScope.$header_logo_cls = 'header-bar-logo-normal';
  return ports_info = portFactory.get({
    paged: $routeParams.page
  }, function() {
    console.log(ports_info);
    $scope.$ports = ports_info.posts;
    $scope.$port_count = ports_info.found;
    $scope.$current_page = $routeParams.page;
    return $scope.$pgs = page_generator(ports_info.found * 22, 15, $routeParams.page);
  });
}).factory('portFactory', [
  '$resource', function($resource) {
    return $resource(sys_cfg.portfolio_data_url, null, {});
  }
]).controller('AboutCtrl', function($rootScope, $scope) {
  var b;
  $rootScope.$pg_type = 'about';
  $rootScope.$header_logo_cls = 'header-bar-logo-about';
  return b = 2;
}).controller('MainCntl', function($rootScope, $scope) {
  var b;
  return b = 1;
});

page_generator = function(total, per, current) {
  var hd, lks, pg, pghd, pgs, tl, _i;
  pgs = Math.floor((total + per - 1) / per);
  if (pgs < 11) {
    hd = 1;
    tl = pgs;
  } else if (current < 6) {
    hd = 1;
    tl = 10;
  } else if ((current + 5) > pgs) {
    tl = pgs;
    hd = pgs - 9;
  } else {
    hd = current - 4;
    tl = current + 5;
  }
  lks = [];
  if (hd > 1) {
    lks.push({
      pg: 1,
      txt: '<<'
    });
  }
  pghd = function(pg) {
    return lks.push({
      pg: pg,
      txt: pg
    });
  };
  for (pg = _i = hd; hd <= tl ? _i <= tl : _i >= tl; pg = hd <= tl ? ++_i : --_i) {
    pghd(pg);
  }
  if (pgs > tl) {
    lks.push({
      pg: pgs,
      txt: '>>'
    });
  }
  return lks;
};
